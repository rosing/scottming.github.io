# Git 的一些常用操作

- [常用命令参考](http://robbinfan.com/blog/34/git-common-command)
- [廖雪峰的 Git 教程](http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/0013743862006503a1c5bf5a783434581661a3cc2084efa000)

## 时光机

### 对比

工作区、缓存区、最新 commit 之间的对比？

```
git diff # 工作区与缓存区的差异
git diff -–cached # 缓存区与最新 commit 之间的差异
git diff HEAD # 工作区与最新 commit 之间的差异
```

如何对比当前版本和上一个版本？

```
# 以下三者皆可
git diff @~..@
git diff HEAD^ HEAD
git show @
```

如何对比当前版本和任意版本？

```
git diff commit_id HEAD
git diff commit_id @
```

其他的一些对比，参考 TLCL 的文本操作

```
diff -c file1 file2 # 比较两个文件，上下文模式
diff -u file1 file2 # 比较两个文件，统一模式
```

### 撤销与回退

如何撤销工作区编辑？

```
git config --global alias.co checkout # git checkout 比较常用，设个别名
git co .
git co -- filename
```

如何撤销缓存区？

```
git reset HEAD filename # add 之后，恢复后回到编辑状态。
git reset @ filename # 同上
```

提交到版本库之后如何回退？

```
# 会把当前历史删除的做法
git log --pretty=oneline # 查看最近的日志
git reset --hard @~ # 直接回退到上一个版本
git reset --hard HEAD^ # 同上 

# 比较安全的做法
git revert <$id>    # 恢复某次提交的状态，恢复动作本身也创建了一次提交对象，需重写 commit
git revert HEAD     # 恢复最后一次提交的状态

# 感觉自己这次写错了
get reset @~ # 回到工作区的编辑状态，跟上方的 hard 还是有区别的。
```

改变 git log 至标准输出

```
git config pager.log false
```

## 分支管理

Fetch 分支、对比

```
git fetch origin master 
git diff ..FETCH_HEAD # 对比当前版本库和 Fetch 的内容
git diff @..FETCH_HEAD # 同上
